!function(t){"use strict";var e=tinymce.util.Tools.resolve("tinymce.Resource"),n=tinymce.util.Tools.resolve("tinymce.util.Promise"),a=tinymce.util.Tools.resolve("tinymce.util.Delay"),i="/js/twemoji-database.min.js",s="/assets/72x72",o=["/assets/css/activity.min.css","/assets/css/animals-nature.min.css","/assets/css/flags.min.css","/assets/css/food-drink.min.css","/assets/css/objects.min.css","/assets/css/smileys-people.min.css","/assets/css/symbols.min.css","/assets/css/travel-places.min.css"],c="Smileys & People";function r(t,e,n){t.insertContent(function(t,e){var n=t.split(","),a=n[0];return'<img style="width:20px;height:20px;vertical-align:middle;" draggable="false" title="'+n[1]+'" alt="'+n[2]+'" src="'+(e+s)+"/"+a+'.png"/>'}(e,n))}function l(t,e){return e=e||c,(e=t.find(function(t){return t.name===c}))&&e.emojis}tinymce.PluginManager.requireLangPack("twemoji"),tinymce.PluginManager.add("twemoji",function(s,u){o.forEach(function(t){tinymce.DOM.loadCSS(u+t)});var m,d,f,p=function(s,o){var c={hasLoaded:!1,categories:[]},r=o+i,l=s.getParam("twemoji_database_id","tinymce.plugins.twemoji","string"),u=s.getParam("twemoji_database_url",r);return s.on("init",function(){e.load(l,u).then(function(t){c.categories=t.map(function(t){return Object.assign({},t,{emojis:t.emojis.map(function(t){var e=t.codePoint+","+t.name+","+t.char,n=function(t){var e=t.split(",");return'<div draggable="false" style="width:20px;height:20px;" id="twemoji-'+e[0]+'" title="'+e[1]+'" alt="'+e[2]+'"></div>'}(e);return Object.assign({},t,{text:t.name,icon:n,value:e})})})}),c.hasLoaded=!0},function(e){t.console.log("Failed to load twemoji: "+e)})}),c.waitForLoad=function(){return c.hasLoaded?n.resolve(!0):new n(function(e,n){var i=15,s=a.setInterval(function(){c.hasLoaded?(a.clearInterval(s),e(!0)):--i<0&&(t.console.log("Could not load twemoji from url: "+u),a.clearInterval(s),n(!1))},100)})},c}(s,u),g=(m=function(t){var e,n,a=t.getData();t.setData({results:(e=l(p.categories),n=a.pattern,n=new RegExp(n,"i"),e.filter(function(t){return t.name.match(n)}))})},d=200,f=Date.now(),function(){var t=Date.now();if(t-f>=d)return f=t,m.apply(null,Array.prototype.slice.call(arguments))}),w=function(){var t={type:"tabpanel",tabs:p.categories.map(function(t){return{title:t.name,name:t.name,items:[{label:s.translate("Search"),type:"input",name:"pattern"},{type:"collection",name:"results"}]}})};return{title:s.translate("Twemoji icons"),size:"normal",body:t,initialData:{pattern:"",results:l(p.categories)},onTabChange:function(t,e){c=e.newTabName,g(t)},onChange:g,onAction:function(t,e){"results"===e.name&&(r(s,e.value,u),t.close())},buttons:[{type:"cancel",text:"Close",primary:!0}]}};return s.ui.registry.addIcon("twemoji_icon",'<svg width="24" height="24" data-prefix="fas" data-icon="icons" class="svg-inline--fa fa-icons fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M116.65 219.35a15.68 15.68 0 0 0 22.65 0l96.75-99.83c28.15-29 26.5-77.1-4.91-103.88C203.75-7.7 163-3.5 137.86 22.44L128 32.58l-9.85-10.14C93.05-3.5 52.25-7.7 24.86 15.64c-31.41 26.78-33 74.85-5 103.88zm143.92 100.49h-48l-7.08-14.24a27.39 27.39 0 0 0-25.66-17.78h-71.71a27.39 27.39 0 0 0-25.66 17.78l-7 14.24h-48A27.45 27.45 0 0 0 0 347.3v137.25A27.44 27.44 0 0 0 27.43 512h233.14A27.45 27.45 0 0 0 288 484.55V347.3a27.45 27.45 0 0 0-27.43-27.46zM144 468a52 52 0 1 1 52-52 52 52 0 0 1-52 52zm355.4-115.9h-60.58l22.36-50.75c2.1-6.65-3.93-13.21-12.18-13.21h-75.59c-6.3 0-11.66 3.9-12.5 9.1l-16.8 106.93c-1 6.3 4.88 11.89 12.5 11.89h62.31l-24.2 83c-1.89 6.65 4.2 12.9 12.23 12.9a13.26 13.26 0 0 0 10.92-5.25l92.4-138.91c4.88-6.91-1.16-15.7-10.87-15.7zM478.08.33L329.51 23.17C314.87 25.42 304 38.92 304 54.83V161.6a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V99.66l112-17.22v47.18a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V32c0-19.48-16-34.42-33.92-31.67z"></path></svg>'),s.ui.registry.addButton("twemoji",{icon:"twemoji_icon",tooltip:"Twemoji icons",onAction:function(){!function(t,e){var n=t.windowManager.open(w());e.hasLoaded?(n.showTab(c),n.focus("pattern")):(n.block(t.translate("Loading emoticons...")),e.waitForLoad().then(function(){n.redial(w()),g(n),n.focus("pattern")}).catch(function(e){n.redial({title:t.translate("Twemoji icons"),body:{type:"panel",items:[{type:"alertbanner",level:"error",icon:"warning",text:"<p>"+t.translate("Could not load twemoji")+"</p>"}]},buttons:[{type:"cancel",text:"Close",primary:!0}],initialData:{pattern:"",results:[]}}),n.focus("pattern"),n.showTab(c),n.unblock()}))}(s,p)}}),{getMetadata:function(){}}})}(window);